var express = require('express');
var dvna = express();

dvna.get('/evaluate', function(request, response) {
  var res = eval("("+request.query.e+")");
  response.send('Parameter eval():<br> ' + res);
});

dvna.get('/build_function', function(request, response) {
  // Another instance of the same vulnerability but in this instance we build a function instead of evaluating a parameter value
  var invokeCustomFunction = new Function("create", request.query.e);
  var isVulnerable = true;
  var functionCallReturn = invokeCustomFunction(isVulnerable);
  response.send('Invoke our custom function: ' + functionCallReturn);
});

module.exports = {
  title: 'Remote Code Execution (RCE)',
  server: dvna
}
